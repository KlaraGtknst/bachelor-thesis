\newcommand{\databaseName}{Elasticsearch}
\chapter{Implementation}\label{ch:implementation}

\section{Database Elasticsearch}\label{subsec:db}
% introduction, users
\databaseName{} is a widely used non-relational database, which was designed to store and perform full-text search on large corpus of unstructured data \cite{Elasticsearch2017}.
This open-source distributed document-driven database system is build in Java and is based on the Apache Lucene (Java) library for high-speed full-text search \cite{Elasticsearch2017,Elasticsearch2019}.
According to \cite{Elasticsearch2019}, \databaseName{} provides Wikipedia's full-text search and suggestions as well as Github's code search and Stack Overflow's geolocation queries and related questions.
Needless to say, \databaseName{} is prone to handle Big Data and enables near real-time search by index refreshing periods of one second.

% structure
\databaseName{}'s entries, i.e. documents are stored in logical units, so called indices.
% index
As stated in \citeauthor{Elasticsearch2019} and \citeauthor{Elasticsearch2017}'s work, the indices are structured similar to Apache Lucene's inverted index format.
An index can be spread into multiple nodes.
A node is single running instance of \databaseName{} \cite{Elasticsearch2019}.
An index is divided into one or more shards, which can be stored on different servers and enable parallelization \cite{Elasticsearch2019}.

% document
\databaseName{} indices' entries are documents, which are saved in a \ac{json} fromat \cite{Elasticsearch2017}.
A document's fields and field types are defined by the user when initializing the database index.
By default, every field of a document is indexed and searchable \cite{Elasticsearch2019}.

% Replicas
Replicas are copies of shards, which create redundancy and thus, ensure availability \cite{Elasticsearch2019}.


% content
The database is filled once with data from a large unstructured corpus of \acp{pdf}.
After the initialization of the database, it is used for queries. 
Therefore, the procedure is carries out in a completely offline fashion.

The index \textit{Bahamas} stores different embeddings of the text layer information and metadata of the documents.

\begin{table}[htp]
    \centering
    \caption{Fields in \databaseName{} database in index \textit{Bahamas}}
    \begin{tabular}{|l|l|l|l|l|l|l|l|l|l|l|}
    \hline
        \_id & doc2vec & sim\_docs\_tfidf & google\_univ\_sent\_encoding & huggingface\_sent\_tarnsformer & inferSent\_AE & pca\_image & pca\_kmeans\_cluster & text & path & image \\
        \hline
        unique identifier of document \texttt{i} & doc2vec embedding of \texttt{i} & sim\_docs\_tfidf embedding of \texttt{i} & google\_univ\_sent\_encoding embedding of \texttt{i} & huggingface\_sent\_tarnsformer embedding of \texttt{i} & inferSent\_AE embedding of \texttt{i} & two dimensional \ac{pca} version of first page image of \texttt{i} & Cluster of \texttt{i} identified by KMeans on \ac{pca} version of image & text of \texttt{i} & path on local maschine to \texttt{i} & image of first page of \texttt{i} \\
        \hline
    \end{tabular}
    \label{tbl:Elasticsearch-fields}
\end{table}

% query (endpoints)
% get

% search id

% full-text search

% knn-search


columns are embeddings, rows are documents

\begin{figure}[htp] % htp = hier (h), top (t), oder auf einer eigenen Seite (p).
    \centering
    \includesvg[width=0.5\textwidth]{images/PDFs_to_database}
    \caption{Das Logo der Uni Kassel}
    \label{fig:pdf2db}
\end{figure}

\begin{figure}[htp] % htp = hier (h), top (t), oder auf einer eigenen Seite (p).
    \centering
    \includesvg[width=1.0\textwidth]{images/TFIDF_preprocessing}
    \caption{TFIDF Preprocessing}
    \label{fig:preprocessing}
\end{figure}

\section{User Interface}\label{sec:ui}